# TODO

## To do

- [ ] 

## To learn

OWASP file upload best practises:

- [ ] List allowed extensions. Only allow safe and critical extensions for business functionality
- [ ] Ensure that input validation is applied before validating the extensions.
- [ ] Validate the file type, don't trust the Content-Type header as it can be spoofed
- [ ] Change the filename to something generated by the application
- [ ] Set a filename length limit. Restrict the allowed characters if possible
- [ ] Set a file size limit
- [ ] Only allow authorized users to upload files
- [ ] Store the files on a different server. If that's not possible, store them outside of the webroot
- [ ] In the case of public access to the files, use a handler that gets mapped to filenames inside the application (someid -> file.ext)
- [ ] Run the file through an antivirus or a sandbox if available to validate that it doesn't contain malicious data
- [ ] Ensure that any libraries used are securely configured and kept up to date
- [ ] Protect the file upload from CSRF attacks

## Resources

- [ ] [Input_Validation_Cheat_Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html#file-upload-validation)
- [ ] [File_Upload_Cheat_Sheet](https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html)
- [ ] [Studocu organic uploader file validators](https://github.com/StuDocu/studocu-frontend/blob/main/apps/studocu/utils/uploader/fileValidators.ts)
- [ ] [ZSA Server Action in Next.JS Apps](https://reetesh.in/blog/zsa-server-action-in-next.js-apps)
- [x] [You Suck at Securing S3, Here's Why](https://env.fail/posts/aws-s3/)